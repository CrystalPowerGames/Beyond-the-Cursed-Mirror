#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"
#include "actors/group0.h"

/* Fast64 begin persistent block [includes] */
/* Fast64 end persistent block [includes] */

#include "make_const_nonconst.h"
#include "levels/hmc/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_hmc_entry[] = {
	INIT_LEVEL(),
	LOAD_YAY0(0x07, _hmc_segment_7SegmentRomStart, _hmc_segment_7SegmentRomEnd), 
	LOAD_YAY0_TEXTURE(0x09, _cave_yay0SegmentRomStart, _cave_yay0SegmentRomEnd), 
	LOAD_YAY0(0x05, _group6_yay0SegmentRomStart, _group6_yay0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group6_geoSegmentRomStart, _group6_geoSegmentRomEnd), 
	LOAD_YAY0(0x06, _group17_yay0SegmentRomStart, _group17_yay0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group17_geoSegmentRomStart, _group17_geoSegmentRomEnd), 
	LOAD_YAY0(0x08, _common0_yay0SegmentRomStart, _common0_yay0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	LOAD_YAY0(0xa, _water_skybox_yay0SegmentRomStart, _water_skybox_yay0SegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_7), 
	JUMP_LINK(script_func_global_18), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_WOODEN_DOOR, wooden_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_DOOR, metal_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_HAZY_MAZE_DOOR, hazy_maze_door_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_PLATFORM, hmc_geo_0005A0), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_METAL_ARROW_PLATFORM, hmc_geo_0005B8), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ELEVATOR_PLATFORM, hmc_geo_0005D0), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ROLLING_ROCK, hmc_geo_000548), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ROCK_PIECE, hmc_geo_000570), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_ROCK_SMALL_PIECE, hmc_geo_000588), 
	LOAD_MODEL_FROM_GEO(MODEL_HMC_RED_GRILLS, hmc_geo_000530), 
	LOAD_MODEL_FROM_GEO(MODEL_MINECART, minecart_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_BOULDER, wboulder_geo), //MODEL_COBIE
	LOAD_MODEL_FROM_GEO(MODEL_COBIE, cobie_geo), 
	//LOAD_MODEL_FROM_GEO(MODEL_BILLMASK_C6, billmask_geo), 

	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, hmc_area_1),
		WARP_NODE(0x0A, LEVEL_HMC, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x00, LEVEL_HMC, 0x02, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 0x03, 0x05, WARP_NO_CHECKPOINT),
		WARP_NODE(241, LEVEL_CASTLE, 0x03, 0x04, WARP_NO_CHECKPOINT),
		WARP_NODE(0x01, LEVEL_HMC, 0x03, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x02 /*exit*/, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_ATM, -6662, 45, -174, 0, 139, 0, 0x00000000, bhvATM),
		OBJECT(MODEL_BLUE_COIN_SWITCH, -36, 309, -3530, 0, 0, 0, 0x00000000, bhvBlueCoinSwitch),
		OBJECT(MODEL_BILLMASK_C6, 2740, 1149, -3484, 0, 0, 0, (2 << 16), bhvCrowbarPower),
		OBJECT(MODEL_BLUE_COIN, -446, -48, -3279, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, -310, -25, -2366, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, -96, 188, -1527, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 980, 249, -1791, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 1898, 237, -1574, 0, 0, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BOULDER, 12311, 7853, -407, 0, 107, 0, (1 << 16), bhvBoulder),
		OBJECT(MODEL_BOULDER, 11279, 7853, -407, 0, 107, 0, (2 << 16), bhvBoulder),
		OBJECT(MODEL_BOULDER, 12311, 8233, -407, 0, 107, 0, (100 << 24) | (1 << 16), bhvBoulder),
		OBJECT(MODEL_BOULDER, 11279, 8233, -407, 0, 107, 0, (100 << 24) | (2 << 16), bhvBoulder),
		OBJECT(MODEL_BOULDER, 12311, 8593, -407, 0, 107, 0, (200 << 24) | (1 << 16), bhvBoulder),
		OBJECT(MODEL_BOULDER, 11279, 8593, -407, 0, 107, 0, (200 << 24) | (2 << 16), bhvBoulder),
		OBJECT(MODEL_EXCLAMATION_BOX, -7109, 1415, 255, 0, 0, 0, (5 << 16), bhvExclamationBox),
		OBJECT(MODEL_EXCLAMATION_BOX, -459, -397, -431, 0, 0, 0, (5 << 16), bhvExclamationBox),
		OBJECT(MODEL_EXCLAMATION_BOX, 4496, 1948, -2685, 0, 0, 0, (4 << 16), bhvExclamationBox),
		OBJECT(MODEL_EXCLAMATION_BOX, -439, 529, -7560, 0, 0, 0, (4 << 16), bhvExclamationBox),
		OBJECT(MODEL_EXCLAMATION_BOX, -7507, 291, -737, 0, 0, 0, (1 << 16), bhvExclamationBox),
		OBJECT(MODEL_COBIE, -1607, 0, -783, 0, 0, 0, (62 << 16), bhvCobie),
		OBJECT_WITH_ACTS(MODEL_COBIE, -5982, -17, -798, 0, 90, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT_WITH_ACTS(MODEL_COBIE, -6955, 592, -144, 0, 90, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT(MODEL_COBIE, 924, 668, -2304, 0, -11, 0, 0x00000000, bhvEvilCobie),
		OBJECT(MODEL_COBIE, 8013, 5446, -6837, 0, 90, 0, 0x00000000, bhvEvilCobie),
		OBJECT(MODEL_COBIE, -1533, 1051, -7570, 0, -90, 0, 0x00000000, bhvEvilCobie),
		OBJECT(MODEL_COBIE, -1533, 1980, -7570, 0, -90, 0, 0x00000000, bhvEvilCobie),
		OBJECT(MODEL_COBIE, -3455, 322, -6015, 0, 90, 0, 0x00000000, bhvEvilCobie),
		OBJECT_WITH_ACTS(MODEL_COBIE, -6352, 1122, 313, 0, -180, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT(MODEL_COBIE, 3126, 1149, -3188, 0, -90, 0, (63 << 16), bhvCobie),
		OBJECT(MODEL_COBIE, 10625, 6261, 1316, 0, -90, 0, (64 << 16), bhvCobie),
		OBJECT(MODEL_COBIE, -4608, 508, -5939, 0, 59, 0, (65 << 16), bhvCobie),
		OBJECT_WITH_ACTS(MODEL_COBIE, -4102, -17, -350, 0, 94, 0, (4 << 24) | (66 << 16), bhvCobie, ACT_5),
		OBJECT_WITH_ACTS(MODEL_COBIE, -5060, 592, -1236, 0, 90, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT_WITH_ACTS(MODEL_COBIE, -6166, 45, -1251, 0, 34, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT_WITH_ACTS(MODEL_COBIE, -7044, 45, -1251, 0, 34, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT_WITH_ACTS(MODEL_COBIE, -5406, 45, -96, 0, 142, 0, 0x00000000, bhvEvilCobie, ACT_5),
		OBJECT(MODEL_COBIE, 12448, 6394, -8674, 0, -31, 0, 0x00000000, bhvEvilCobie),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 2683, 1741, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 2683, 1899, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 2683, 2044, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 2683, 2190, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 3128, 1291, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 3128, 1450, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 3128, 1594, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN_NO_SHADOW, 6351, 3128, 1741, 0, 0, 0, 0x00000000, bhvYellowCoin),
		OBJECT(MODEL_NONE, 8286, 1127, -5453, 0, -26, 0, (2 << 16), bhvInstantActiveWarp),
		OBJECT(MODEL_NONE, 2898, 1670, -2793, 0, 77, 0, 0x00040000, bhvCoinFormation),
		OBJECT(MODEL_NONE, -1975, 774, -7570, 0, 90, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, -1975, 1707, -7570, 0, 90, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, 4320, 3019, -8274, 0, 90, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, 6305, 5182, -6521, 0, -180, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, 900, 859, -1745, 0, -180, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, 1760, 2259, -2655, 0, -180, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, -5457, 592, -143, 0, 90, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_NONE, 2553, 3425, 3023, 0, -180, 0, 0x00020000, bhvCoinFormation),
		OBJECT(MODEL_NONE, -5619, -17, -1615, 0, -180, 0, 0x00000000, bhvCoinFormation),
		OBJECT(0xEF, -5414, 1122, -1948, 0, 0, 0, 0x00000000, bhvGreenCoin),
		OBJECT(MODEL_MINECART, 554, 42, -1639, 0, 107, 0, 0x00000000, bhvMinecart),
		OBJECT(MODEL_MINECART, -5031, 544, -5738, 0, -88, 0, (1 << 24) | (3 << 16), bhvMinecart),
		OBJECT(MODEL_1UP, -2744, 2044, -7432, 0, 0, 0, 0x00000000, bhv1Up),
		OBJECT(MODEL_1UP, -4357, 953, 262, 0, 0, 0, 0x00000000, bhv1Up),
		OBJECT(MODEL_1UP, 3223, 4580, 2186, 0, 0, 0, 0x00000000, bhv1Up),
		OBJECT(MODEL_1UP, 6352, 3634, 2792, 0, 0, 0, 0x00000000, bhv1Up),
		OBJECT(MODEL_1UP, 10613, 7374, -6574, 0, 0, 0, 0x00000000, bhv1Up),
		OBJECT(MODEL_NONE, -2572, 123, -6869, 0, 0, 0, 0x00010000, bhv_SafeZone),
		OBJECT(MODEL_NONE, 5996, 2895, -8176, 0, 0, 0, 0x00010000, bhv_SafeZone),
		OBJECT(MODEL_NONE, 517, -17, -179, 0, 0, 0, 0x00010000, bhv_SafeZone),
		OBJECT(MODEL_NONE, -4850, -17, -695, 0, 0, 0, 0x00020000, bhv_SafeZone),
		OBJECT(MODEL_NONE, -940, 2445, -8241, 0, 0, 0, 0x00010000, bhv_SafeZone),
		OBJECT(MODEL_NONE, 1967, 668, -3315, 0, 0, 0, 0x00010000, bhv_SafeZone),
		OBJECT(MODEL_NONE, -2026, 101, -229, 0, -180, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_STAR, 10636, 6526, 706, 0, 0, 0, (0 << 24), bhvStar),
		OBJECT(MODEL_STAR, 942, 4060, 2784, 0, 0, 0, (1 << 24), bhvStar),
		OBJECT(0xE3, 2879, 2205, -924, 0, 0, 0, (5 << 16), bhv_Wallet),
		OBJECT(MODEL_NONE, 8514, 1337, -6124, 0, 0, 0, (4 << 24), bhvWarp),
		OBJECT(MODEL_NONE, 8514, 1152, -6124, 0, 0, 0, (20 << 24), bhvWarp),
		TERRAIN(hmc_area_1_collision),
		MACRO_OBJECTS(hmc_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_FARM),
		TERRAIN_TYPE(TERRAIN_SPOOKY),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(2, hmc_area_2),
		WARP_NODE(0x0A, LEVEL_HMC, 0x02, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 0x03, 0x05, WARP_NO_CHECKPOINT),
		WARP_NODE(241, LEVEL_CASTLE, 0x03, 0x04, WARP_NO_CHECKPOINT),
		WARP_NODE(0x00 /*exit*/, LEVEL_HMC, 0x01, 0x02, WARP_NO_CHECKPOINT),
		WARP_NODE(0x01/*minigame*/, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_SWOOP, 1361, 437, 1676, 0, -180, 0, 0x00000000, bhvSwoop),
		OBJECT(MODEL_SWOOP, -59, 314, -350, 0, 22, 0, 0x00000000, bhvSwoop),
		OBJECT(MODEL_SWOOP, -1171, 732, 477, 0, 91, 0, 0x00000000, bhvSwoop),
		OBJECT(MODEL_SWOOP, -833, 740, -5624, 0, 1, 0, 0x00000000, bhvSwoop),
		OBJECT(0xEF, 1595, 427, 2724, 0, 0, 0, 0x00000000, bhvGreenCoin),
		OBJECT(0xEF, 847, -440, -5719, 0, 0, 0, 0x00000000, bhvGreenCoin),
		OBJECT(MODEL_NONE, -718, -240, -5209, 0, 0, 0, (3 << 24), bhvJumprope),
		OBJECT(MODEL_MINECART, -2041, 486, 361, 0, -88, 0, (1 << 24) | (5 << 16), bhvMinecart),
		OBJECT(MODEL_MINECART, 84, 373, -1251, 0, -88, 0, (0 << 24) | (4 << 16), bhvMinecart),
		OBJECT(MODEL_RED_COIN, 1384, 683, 1608, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 2162, -160, -1800, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 763, -440, -3844, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -2106, -440, -2649, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, 1647, 1449, -3152, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -868, 919, -5697, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -428, 1776, 1873, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_RED_COIN, -1311, -97, 3616, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_NONE, -84, 310, -962, 0, 0, 0, (2 << 24), bhvHiddenRedCoinStar),
		OBJECT(MODEL_WOODEN_SIGNPOST, -361, -440, -4816, 0, 28, 0, (61 << 16), bhvMessagePanel),
		OBJECT(MODEL_NONE, 0, 0, 6137, 0, -180, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_NONE, -718, 219, -5209, 0, -180, 0, (1 << 16), bhvSpinAirborneWarp),
		OBJECT(MODEL_NONE, -4, -100, 6739, 0, 0, 0, (0 << 16), bhvWarp),
		OBJECT(MODEL_NONE, 182, -100, 6739, 0, 0, 0, (0 << 16), bhvWarp),
		OBJECT(MODEL_NONE, -278, -100, 6739, 0, 0, 0, (0 << 16), bhvWarp),
		TERRAIN(hmc_area_2_collision),
		MACRO_OBJECTS(hmc_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_UNDERGROUND),
		TERRAIN_TYPE(TERRAIN_SPOOKY),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	AREA(3, hmc_area_3),
		WARP_NODE(0x0A, LEVEL_HMC, 0x02, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 0x03, 0x05, WARP_NO_CHECKPOINT),
		WARP_NODE(241, LEVEL_CASTLE, 0x03, 0x04, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_COBIE, 4138, -433, 0, 0, 90, 0, (6 << 24), bhvBossCobie),
		OBJECT(MODEL_NONE, 5641, 284, 0, 0, -90, 0, 0x000A0000, bhvSpinAirborneWarp),
		TERRAIN(hmc_area_3_collision),
		MACRO_OBJECTS(hmc_area_3_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_EVENT_BOSS),
		TERRAIN_TYPE(TERRAIN_SPOOKY),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
